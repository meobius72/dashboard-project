<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëŒ€ì‹œë³´ë“œ</title>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif; /* í•œêµ­ì–´ í°íŠ¸ ì¶”ê°€ */
            margin: 0;
            padding: 0; /* ì „ì²´ íŒ¨ë”© ì œê±°, ì»¨í…Œì´ë„ˆì—ì„œ ê´€ë¦¬ */
            background-color: #1a1a2e; /* ì–´ë‘ìš´ ë°°ê²½ */
            color: #e0e0e0;
        }
        .dashboard-container {
            display: grid;
            gap: 20px;
            max-width: 1300px; /* ë„ˆë¹„ í™•ì¥ */
            margin: 20px auto; /* ìƒí•˜ ì—¬ë°± ì¶”ê°€ */
            padding: 20px; /* ë‚´ë¶€ íŒ¨ë”© */
        }
        .top-section {
            display: grid;
            grid-template-columns: 2fr 1fr; /* Video takes more space than announcements */
            gap: 20px;
        }
        .video-section {
            background-color: #2a2a4e; /* ì–´ë‘ìš´ ìƒ‰ìƒ */
            color: #e0e0e0;
            padding: 0; /* ë‚´ë¶€ íŒ¨ë”©ì€ í—¤ë”ì—ì„œ ê´€ë¦¬ */
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            position: relative;
            padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
            height: 0;
            overflow: hidden;
        }
        .video-section iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        .video-header {
            background-color: #6a0dad; /* ë³´ë¼ìƒ‰ ê³„ì—´ */
            padding: 10px 20px;
            margin-bottom: 20px; /* í—¤ë” ì•„ë˜ ì—¬ë°± */
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
            font-weight: bold;
            font-size: 1.1em;
            display: flex;
            align-items: center;
        }
        .video-header svg { /* ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
            margin-right: 10px;
            width: 20px;
            height: 20px;
            fill: currentColor;
        }
        .video-placeholder {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #aaa;
        }
        .announcement-section {
            background-color: #2a2a4e; /* ì–´ë‘ìš´ ìƒ‰ìƒ */
            padding: 0; /* ë‚´ë¶€ íŒ¨ë”©ì€ í—¤ë”ì—ì„œ ê´€ë¦¬ */
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        .announcement-header {
            background-color: #6a0dad; /* ë³´ë¼ìƒ‰ ê³„ì—´ */
            padding: 10px 20px;
            margin-bottom: 20px; /* í—¤ë” ì•„ë˜ ì—¬ë°± */
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
            font-weight: bold;
            font-size: 1.1em;
            display: flex;
            align-items: center;
        }
        .announcement-header svg { /* ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
            margin-right: 10px;
            width: 20px;
            height: 20px;
            fill: currentColor;
        }
        .announcement-tabs {
            display: flex;
            border-bottom: 1px solid #4a4a6e; /* ì–´ë‘ìš´ ê²½ê³„ì„  */
            margin: 0 20px 15px 20px; /* ì¢Œìš° íŒ¨ë”© */
        }
        .announcement-tabs button {
            background-color: #3a3a5e; /* ì–´ë‘ìš´ íƒ­ ë°°ê²½ */
            border: none;
            padding: 10px 15px;
            cursor: pointer;
            font-weight: bold;
            flex-grow: 1;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
            color: #ccc;
            transition: background-color 0.3s, color 0.3s;
        }
        .announcement-tabs button.active {
            background-color: #007bff; /* í™œì„± íƒ­ íŒŒë€ìƒ‰ */
            color: white;
            border-bottom: 2px solid #007bff; /* í™œì„± íƒ­ ì•„ë˜ì¤„ ê°•ì¡° */
        }
        .announcement-tabs button:hover:not(.active) {
            background-color: #4a4a6e;
            color: #eee;
        }
        .tab-content {
            display: none;
            padding: 0 20px; /* ì¢Œìš° íŒ¨ë”© */
            max-height: 300px; /* ìŠ¤í¬ë¡¤ì„ ìœ„í•œ ìµœëŒ€ ë†’ì´ */
            overflow-y: auto; /* ë‚´ìš©ì´ ë„˜ì¹˜ë©´ ìŠ¤í¬ë¡¤ */
        }
        .tab-content.active {
            display: block;
        }
        .announcement-item {
            background-color: #3a3a5e; /* í•­ëª© ë°°ê²½ìƒ‰ */
            margin-bottom: 10px;
            padding: 15px;
            border-radius: 5px;
            transition: background-color 0.2s;
        }
        .announcement-item:hover {
            background-color: #4a4a6e;
        }
        .announcement-item:last-child {
            margin-bottom: 0;
            border-bottom: none;
        }
        .announcement-item div:first-child {
            font-weight: bold;
            margin-bottom: 5px;
            color: #e0e0e0;
        }
        .announcement-item .date {
            font-size: 0.85em;
            color: #aaa;
        }
        .weather-section {
            background-color: #2a2a4e; /* ì–´ë‘ìš´ ë°°ê²½ */
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column; /* ì„¸ë¡œë¡œ ì •ë ¬ */
        }
        .weather-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            font-size: 1.2em;
            font-weight: bold;
            color: #e0e0e0;
        }
        .weather-header .location {
            display: flex;
            align-items: center;
        }
        .weather-header .location svg {
            margin-right: 8px;
            width: 24px;
            height: 24px;
            fill: #007bff; /* íŒŒë€ìƒ‰ ì•„ì´ì½˜ */
        }
        .weather-cards-container {
            display: flex;
            justify-content: space-around;
            align-items: flex-start; /* ìƒë‹¨ ì •ë ¬ */
            flex-wrap: wrap; /* ë°˜ì‘í˜• */
            overflow-x: auto; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ */
            padding-bottom: 10px; /* ìŠ¤í¬ë¡¤ë°” ê³µê°„ */
        }
        .weather-card {
            background-color: #3a3a5e; /* ì¹´ë“œ ë°°ê²½ìƒ‰ */
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 10px;
            min-width: 140px; /* ì¹´ë“œ ë„ˆë¹„ ì¡°ì • */
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            color: #e0e0e0;
        }
        .weather-card .time {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 8px;
            color: #007bff; /* ì‹œê°„ íŒŒë€ìƒ‰ */
        }
        .weather-card .icon {
            font-size: 2.5em; /* ì•„ì´ì½˜ í¬ê¸° í‚¤ì›€ */
            margin-bottom: 8px;
        }
        .weather-card .temp {
            font-size: 1.8em; /* ì˜¨ë„ í¬ê¸° í‚¤ì›€ */
            font-weight: bold;
            margin-bottom: 8px;
        }
        .weather-card .details {
            font-size: 0.9em;
            color: #aaa;
            line-height: 1.4;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="dashboard-container">
        <div class="top-section">
            <div class="video-section">
                <div class="video-header">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-3 10l-7-4V7l7 4v4z"></path></svg>
                    êµìœ¡ì› í™ë³´ ë™ì˜ìƒ
                </div>
                <!-- YouTube ë˜ëŠ” Vimeo ì„ë² ë“œ ì½”ë“œ (16:9 ë¹„ìœ¨ ìœ ì§€) -->
                <!-- ì˜ˆì‹œ: <iframe src="https://www.youtube.com/embed/VIDEO_ID" allowfullscreen></iframe> -->
                <iframe src="https://www.youtube.com/embed/vsSxqmwnYvA?mute=1&loop=1&autoplay=1&playlist=yCp0I4KuWJo" style="position:absolute;width:100%;height:100%;left:0" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>

            <div class="announcement-section">
                <div class="announcement-header">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"></path></svg>
                    ê³µì§€ì‚¬í•­
                </div>
                <div class="announcement-tabs">
                    <button class="tab-button active" onclick="openTab(event, 'tsNotice')">TS êµ­ê°€ìê²©ì‹œí—˜</button>
                    <button class="tab-button" onclick="openTab(event, 'aviationAlert')">í•­ê³µêµìœ¡ ì•Œë¦¼</button>
                    <button class="tab-button" onclick="openTab(event, 'aviationNotice')">í•­ê³µêµìœ¡ ê³µì§€</button>
                </div>

                <div id="tsNotice" class="tab-content active">
                    <div class="announcement-item">
                        <div>2025ë…„ ì œ1íšŒ êµí†µì•ˆì „ê´€ë¦¬ì ìê²©ì‹œí—˜ ì‹œí–‰ê³„íš ê³µê³ </div>
                        <div class="date">2025.01.15</div>
                    </div>
                    <div class="announcement-item">
                        <div>2025ë…„ ìœ„í—˜ë¬¼ ìš´ì†¡ì°¨ëŸ‰ ìš´ì „ìê²© ì‹œí—˜ì¼ì • ì•ˆë‚´</div>
                        <div class="date">2025.01.10</div>
                    </div>
                    <div class="announcement-item">
                        <div>êµí†µì•ˆì „ê´€ë¦¬ì ìê²©ì‹œí—˜ ì‘ì‹œ ì„œë¥˜ ë³€ê²½ ì•ˆë‚´</div>
                        <div class="date">2024.12.28</div>
                    </div>
                </div>

                <div id="aviationAlert" class="tab-content">
                    <div class="announcement-item">
                        <div>2025ë…„ í•­ê³µì •ë¹„ êµìœ¡ê³¼ì • ìˆ˜ê°•ì‹ ì²­ ì•Œë¦¼</div>
                        <div class="date">2025.01.16</div>
                    </div>
                    <div class="announcement-item">
                        <div>í•­ê³µêµìœ¡í›ˆë ¨ì› íœ´ë¬´ì¼ì • ì•ˆë‚´</div>
                        <div class="date">2025.01.12</div>
                    </div>
                    <div class="announcement-item">
                        <div>2025ë…„ í•­ê³µ íŠ¹ë³„êµìœ¡ ì¼ì • ê³µì§€</div>
                        <div class="date">2025.01.08</div>
                    </div>
                </div>

                <div id="aviationNotice" class="tab-content">
                    <div class="announcement-item">
                        <div>í•­ê³µì •ë¹„ì‚¬ ìê²©ì¦ëª… êµìœ¡ê³¼ì • ëª¨ì§‘ ê³µê³ </div>
                        <div class="date">2025.01.14</div>
                    </div>
                    <div class="announcement-item">
                        <div>í•­ê³µêµìœ¡í›ˆë ¨í¬í„¸ ì‹œìŠ¤í…œ ì ê²€ ì•ˆë‚´</div>
                        <div class="date">2025.01.09</div>
                    </div>
                    <div class="announcement-item">
                        <div>2025ë…„ í•­ê³µ êµìœ¡ê³¼ì • ìš´ì˜ê³„íš ë°œí‘œ</div>
                        <div class="date">2025.01.05</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="weather-section">
            <div class="weather-header">
                <div class="location">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"></path></svg>
                    <span>ê²½ê¸°ê¸°ê³„ê³µì—…ê³ ë“±í•™êµ</span>
                </div>
                <div>2025ë…„ 6ì›” 12ì¼ ëª©ìš”ì¼</div>
                <div>ìµœì¢… ì—…ë°ì´íŠ¸ ì˜¤ì „ 10:34</div>
            </div>
            <div class="weather-cards-container">
                <div class="weather-card">
                    <div class="time">07:00</div>
                    <div class="icon">â˜€ï¸</div>
                    <div class="temp">18â„ƒ</div>
                    <div class="details">ê°•ìˆ˜ 10%<br>ë°”ëŒ 2.3m/s</div>
                </div>
                <div class="weather-card">
                    <div class="time">10:00</div>
                    <div class="icon">â˜ï¸</div>
                    <div class="temp">22â„ƒ</div>
                    <div class="details">ê°•ìˆ˜ 20%<br>ë°”ëŒ 1.8m/s</div>
                </div>
                <div class="weather-card">
                    <div class="time">13:00</div>
                    <div class="icon">ğŸŒ§ï¸</div>
                    <div class="temp">25â„ƒ</div>
                    <div class="details">ê°•ìˆ˜ 5%<br>ë°”ëŒ 3.1m/s</div>
                </div>
                <div class="weather-card">
                    <div class="time">16:00</div>
                    <div class="icon">â˜”</div>
                    <div class="temp">23â„ƒ</div>
                    <div class="details">ê°•ìˆ˜ 65%<br>ë°”ëŒ 4.2m/s</div>
                </div>
                <div class="weather-card">
                    <div class="time">19:00</div>
                    <div class="icon">â„ï¸</div>
                    <div class="temp">20â„ƒ</div>
                    <div class="details">ê°•ìˆ˜ 30%<br>ë°”ëŒ 2.7m/s</div>
                </div>
            </div>
            <div id="weather-error-message" style="text-align: right; color: red; font-size: 0.9em; margin-top: 10px; display: none;">ë‚ ì”¨ ì •ë³´ ìˆ˜ì§‘ ì˜¤ë¥˜</div>
        </div>
    </div>

    <script>
        function openTab(evt, tabName) {
            var i, tabcontent, tabbuttons;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tabbuttons = document.getElementsByClassName("tab-button");
            for (i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].className = tabbuttons[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        // ì´ˆê¸° ë¡œë“œ ì‹œ ì²« ë²ˆì§¸ íƒ­ í™œì„±í™”
        document.addEventListener("DOMContentLoaded", function() {
            document.querySelector(".tab-button").click();
            updateWeatherDisplay(); // ë‚ ì”¨ ì •ë³´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ í˜¸ì¶œ
        });

        // ë‚ ì”¨ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ (Flask ì„œë²„ì—ì„œ ì‹¤ì œ ë°ì´í„° ì‚¬ìš©)
        async function fetchWeatherData() {
            try {
                const response = await fetch('http://127.0.0.1:5000/weather');
                if (!response.ok) {
                    // HTTP ì˜¤ë¥˜ ë°œìƒ ì‹œ, ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ í¬í•¨í•˜ì—¬ reject
                    const errorText = await response.text();
                    throw new Error(`HTTP error! status: ${response.status}. Response: ${errorText}`);
                }
                const data = await response.json();
                // weather1.pyì˜ ì¶œë ¥ í˜•íƒœì¸ TM_EF_STR, WF, SKY, TA, ST, WSë¥¼ ê°€ì •
                return data.map(item => ({
                    TM_EF: item.TM_EF_STR, // Flaskì—ì„œ TM_EF_STRë¡œ ë°˜í™˜ë˜ë„ë¡ ë³€ê²½
                    WF: item.WF,
                    SKY: item.SKY,
                    TA: item.TA,
                    ST: item.ST,
                    WS: item.WS
                }));
            } catch (error) {
                console.error('ë‚ ì”¨ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                document.getElementById('weather-error-message').style.display = 'block'; // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
                return []; // ì˜¤ë¥˜ ë°œìƒ ì‹œ ë¹ˆ ë°°ì—´ ë°˜í™˜
            }
        }

        // ë‚ ì”¨ ì•„ì´ì½˜ ë§¤í•‘
        const skyCodes = {
            'DB01': 'â˜€ï¸', // ë§‘ìŒ
            'DB02': 'â›…', // êµ¬ë¦„ì¡°ê¸ˆ
            'DB03': 'â˜ï¸', // êµ¬ë¦„ë§ìŒ
            'DB04': 'ğŸŒ§ï¸'  // íë¦¼ (ë¹„/ëˆˆë„ í¬í•¨)
        };
        const weatherIcons = {
            'ë§‘ìŒ': 'â˜€ï¸',
            'êµ¬ë¦„ì¡°ê¸ˆ': 'â›…',
            'êµ¬ë¦„ë§ìŒ': 'â˜ï¸',
            'íë¦¼': 'â˜ï¸',
            'ë¹„': 'â˜”',
            'ëˆˆ': 'â„ï¸'
        };


        // ë‚ ì”¨ ì •ë³´ë¥¼ HTMLì— ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
        async function updateWeatherDisplay() {
            document.getElementById('weather-error-message').style.display = 'none'; // ì´ˆê¸°í™” ì‹œ ì˜¤ë¥˜ ë©”ì‹œì§€ ìˆ¨ê¹€
            const forecastData = await fetchWeatherData();
            const weatherCardsContainer = document.querySelector('.weather-cards-container');
            
            if (forecastData && forecastData.length > 0) {
                weatherCardsContainer.innerHTML = ''; // ê¸°ì¡´ ì¹´ë“œ ì´ˆê¸°í™”
                forecastData.forEach(row => {
                    const dt_obj = new Date(row.TM_EF.substring(0, 4), row.TM_EF.substring(4, 6) - 1, row.TM_EF.substring(6, 8), row.TM_EF.substring(8, 10), row.TM_EF.substring(10, 12));
                    const timeText = dt_obj.toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit', hour12: false });
                    const skyStatus = skyCodes[row.SKY] || weatherIcons[row.WF] || 'â“'; // SKY ì½”ë“œ ë˜ëŠ” WFì— ë”°ë¥¸ ì•„ì´ì½˜

                    const weatherCard = `
                        <div class="weather-card">
                            <div class="time">${timeText}</div>
                            <div class="icon">${skyStatus}</div>
                            <div class="temp">${row.TA}â„ƒ</div>
                            <div class="details">ê°•ìˆ˜ ${row.ST}%<br>ë°”ëŒ ${row.WS}m/s</div>
                        </div>
                    `;
                    weatherCardsContainer.innerHTML += weatherCard;
                });
            } else {
                // ë°ì´í„°ê°€ ì—†ì„ ë•Œ, ê¸°ì¡´ ì¹´ë“œ(í”Œë ˆì´ìŠ¤í™€ë”)ë¥¼ ì§€ìš°ì§€ ì•ŠìŒ. 
                // ëŒ€ì‹ , ì´ë¯¸ `fetchWeatherData`ì—ì„œ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ í‘œì‹œí–ˆìœ¼ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ì¶”ê°€ ì‘ì—… ì—†ì´ ì¢…ë£Œ.
                // ì²˜ìŒ ë¡œë“œ ì‹œ ê¸°ë³¸ ì¹´ë“œ(í”Œë ˆì´ìŠ¤í™€ë”)ê°€ HTMLì— ì´ë¯¸ ìˆìœ¼ë¯€ë¡œ.
                console.log("ë‚ ì”¨ ë°ì´í„° ì—†ìŒ ë˜ëŠ” ì˜¤ë¥˜ ë°œìƒ. ê¸°ì¡´ ë‚ ì”¨ ì¹´ë“œ ìœ ì§€.");
            }
            
            // í˜„ì¬ ë‚ ì§œ ë° ì—…ë°ì´íŠ¸ ì‹œê°„ ì—…ë°ì´íŠ¸
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
            const day = now.getDate();
            const dayOfWeek = ['ì¼ìš”ì¼', 'ì›”ìš”ì¼', 'í™”ìš”ì¼', 'ìˆ˜ìš”ì¼', 'ëª©ìš”ì¼', 'ê¸ˆìš”ì¼', 'í† ìš”ì¼'][now.getDay()];
            const updateTime = now.toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit', hour12: false });

            document.querySelector('.weather-header > div:nth-child(2)').textContent = `${year}ë…„ ${month}ì›” ${day}ì¼ ${dayOfWeek}`;
            document.querySelector('.weather-header > div:nth-child(3)').textContent = `ìµœì¢… ì—…ë°ì´íŠ¸ ${updateTime}`;
        }
    </script>
</body>
</html> 